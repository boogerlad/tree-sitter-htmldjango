================================================================================
Django interpolation
================================================================================

{{ foo }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier))))))

================================================================================
Django filter pipelines
================================================================================

{{ foo.bar|lower:"x"|default:42 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)
          (identifier)))
      (filter_call
        (filter_name)
        (filter_argument
          (literal
            (string))))
      (filter_call
        (filter_name)
        (filter_argument
          (literal
            (number)))))))

================================================================================
Django line comment
================================================================================

{# This is a comment #}

--------------------------------------------------------------------------------

(document
  (django_line_comment))

================================================================================
Django block comment
================================================================================

{% comment %}
ignored content {{ var }}
{% endcomment %}

--------------------------------------------------------------------------------

(document
  (django_block_comment
    (comment_content)))

================================================================================
Django if statement
================================================================================

{% if condition %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django if-elif-else
================================================================================

{% if a %}A{% elif b %}B{% else %}C{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_elif_branch
        (django_elif
          (test_expression
            (or_expression
              (and_expression
                (not_expression
                  (comparison_expression
                    (filter_expression
                      (primary_expression
                        (lookup
                          (identifier))))))))))
        (text))
      (django_else_branch
        (django_else)
        (text))
      (django_endif))))

================================================================================
Django for loop
================================================================================

{% for item in items %}{{ item }}{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_endfor))))

================================================================================
Django for loop with empty
================================================================================

{% for item in items %}{{ item }}{% empty %}No items{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_empty_branch
        (django_empty)
        (text))
      (django_endfor))))

================================================================================
Django with block
================================================================================

{% with foo=bar %}{{ foo }}{% endwith %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_with_block
      (django_with_open
        (with_assignments
          (assignment
            (variable_name)
            (filter_expression
              (primary_expression
                (lookup
                  (identifier)))))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_endwith))))

================================================================================
Django with multiple assignments
================================================================================

{% with foo=bar baz=qux %}content{% endwith %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_with_block
      (django_with_open
        (with_assignments
          (assignment
            (variable_name)
            (filter_expression
              (primary_expression
                (lookup
                  (identifier)))))
          (assignment
            (variable_name)
            (filter_expression
              (primary_expression
                (lookup
                  (identifier)))))))
      (text)
      (django_endwith))))

================================================================================
Django filter with spaces around pipe
================================================================================

{{ foo | lower }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)))
      (filter_call
        (filter_name)))))

================================================================================
Django filter chain with spaces
================================================================================

{{ foo | lower | upper }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)))
      (filter_call
        (filter_name))
      (filter_call
        (filter_name)))))

================================================================================
Django extends tag
================================================================================

{% extends "base.html" %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_extends_tag
      (filter_expression
        (primary_expression
          (literal
            (string)))))))

================================================================================
Django block tag
================================================================================

{% block content %}Hello{% endblock %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_block_block
      (django_block_open
        (block_name))
      (text)
      (django_endblock))))

================================================================================
Django include tag
================================================================================

{% include "partial.html" %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_include_tag
      (filter_expression
        (primary_expression
          (literal
            (string)))))))

================================================================================
Django load tag
================================================================================

{% load static %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_load_tag
      (library_name))))

================================================================================
Django url tag
================================================================================

{% url "view-name" pk=object.pk %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_url_tag
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (named_argument
        (argument_name)
        (filter_expression
          (primary_expression
            (lookup
              (identifier)
              (identifier))))))))

================================================================================
Django csrf token
================================================================================

{% csrf_token %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_csrf_token_tag)))

================================================================================
Django verbatim block
================================================================================

{% verbatim %}{{ not parsed }}{% endverbatim %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_verbatim_block)))

================================================================================
Django autoescape block
================================================================================

{% autoescape off %}{{ html }}{% endautoescape %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_autoescape_block
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier))))))))

================================================================================
Django filter block
================================================================================

{% filter upper %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django spaceless block
================================================================================

{% spaceless %}<p> text </p>{% endspaceless %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_spaceless_block
      (element
        (normal_element
          (tag_name)
          (text)
          (end_tag
            (tag_name)))))))

================================================================================
Django generic tag
================================================================================

{% static "file.css" %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_generic_tag
      (generic_tag_name)
      (tag_argument
        (filter_expression
          (primary_expression
            (literal
              (string))))))))

================================================================================
Django generic block
================================================================================

{% cache 500 sidebar %}content{% endcache %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_generic_block
      (generic_tag_name)
      (tag_argument
        (filter_expression
          (primary_expression
            (literal
              (number)))))
      (tag_argument
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (text)
      (end_tag_name))))

================================================================================
Django lorem tag
================================================================================

{% lorem %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_lorem_tag)))

================================================================================
Django lorem tag with count and method
================================================================================

{% lorem 3 p %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_lorem_tag
      (filter_expression
        (primary_expression
          (literal
            (number))))
      (method))))

================================================================================
Django lorem tag with variable and random
================================================================================

{% lorem count random %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_lorem_tag
      (filter_expression
        (primary_expression
          (lookup
            (identifier)))))))

================================================================================
Django resetcycle tag
================================================================================

{% resetcycle %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_resetcycle_tag)))

================================================================================
Django resetcycle tag with name
================================================================================

{% resetcycle rowcolors %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_resetcycle_tag
      (cycle_name))))

================================================================================
Django querystring tag with named args
================================================================================

{% querystring page=2 q=term %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_querystring_tag
      (named_argument
        (argument_name)
        (filter_expression
          (primary_expression
            (literal
              (number)))))
      (named_argument
        (argument_name)
        (filter_expression
          (primary_expression
            (lookup
              (identifier))))))))

================================================================================
Django querystring tag with positional and named
================================================================================

{% querystring request.path q=term %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_querystring_tag
      (filter_expression
        (primary_expression
          (lookup
            (identifier)
            (identifier))))
      (named_argument
        (argument_name)
        (filter_expression
          (primary_expression
            (lookup
              (identifier))))))))

================================================================================
Django partialdef block
================================================================================

{% partialdef snippet %}Inner{% endpartialdef %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_partialdef_block
      (partial_name)
      (text))))

================================================================================
Django partialdef block with inline and end name
================================================================================

{% partialdef snippet inline %}Body{% endpartialdef snippet %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_partialdef_block
      (partial_name)
      (text)
      (partial_name))))

================================================================================
Django partial tag
================================================================================

{% partial snippet %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_partial_tag
      (partial_name))))

================================================================================
Django verbatim with multi-word suffix
================================================================================

{% verbatim custom name %}{{ not parsed }}{% endverbatim custom name %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_verbatim_block)))

================================================================================
Django i18n string in interpolation
================================================================================

{{ _("hello") }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (i18n_string))))))

================================================================================
Django i18n string with filter
================================================================================

{{ _("hello")|upper }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (i18n_string)))
      (filter_call
        (filter_name)))))

================================================================================
Django filter with i18n string argument
================================================================================

{{ value|default_if_none:_("yes") }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)))
      (filter_call
        (filter_name)
        (filter_argument
          (literal
            (i18n_string)))))))

================================================================================
Django numeric lookup
================================================================================

{{ arr.0 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)
          (numeric_index))))))

================================================================================
Django numeric path segment
================================================================================

{{ data.0.slug }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)
          (numeric_index)
          (identifier))))))

================================================================================
Django with legacy aliases
================================================================================

{% with a as foo and b.c as bar %}X{% endwith %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_with_block
      (django_with_open
        (with_legacy
          (filter_expression
            (primary_expression
              (lookup
                (identifier))))
          (variable_name)
          (filter_expression
            (primary_expression
              (lookup
                (identifier)
                (identifier))))
          (variable_name)))
      (text)
      (django_endwith))))

================================================================================
Django for with tuple unpacking
================================================================================

{% for x, y in items %}{{ x }}{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name)
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_endfor))))

================================================================================
Django for with reversed
================================================================================

{% for item in items reversed %}{{ item }}{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_endfor))))

================================================================================
Django cycle with as and silent
================================================================================

{% cycle 'row1' 'row2' as rowcolors silent %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_cycle_tag
      (cycle_value
        (string))
      (cycle_value
        (string))
      (variable_name))))

================================================================================
Django cycle named reference
================================================================================

{% cycle rowcolors %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_cycle_tag
      (cycle_name))))

================================================================================
Django load from library
================================================================================

{% load foo bar from baz %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_load_tag
      (library_name)
      (library_name)
      (library_name))))

================================================================================
Django filter block with chain
================================================================================

{% filter upper|add:"!" %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name))
        (filter_call
          (filter_name)
          (filter_argument
            (literal
              (string)))))
      (text))))

================================================================================
Django filter block chain with spaces
================================================================================

{% filter upper | lower %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name))
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django filter block space before pipe only
================================================================================

{% filter upper |lower %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name))
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django filter block space after pipe only
================================================================================

{% filter upper| lower %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name))
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django filter block multiple spaces around pipe
================================================================================

{% filter upper  |  lower %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name))
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django filter block with arg then spaced pipe
================================================================================

{% filter add:"!" | lower %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name)
          (filter_argument
            (literal
              (string))))
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django filter block three filters spaced
================================================================================

{% filter upper | lower | title %}text{% endfilter %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_filter_block
      (filter_chain
        (filter_call
          (filter_name))
        (filter_call
          (filter_name))
        (filter_call
          (filter_name)))
      (text))))

================================================================================
Django include with context
================================================================================

{% include "partial.html" with foo="bar" only %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_include_tag
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (assignment
        (variable_name)
        (filter_expression
          (primary_expression
            (literal
              (string))))))))

================================================================================
Django include with multiple assignments
================================================================================

{% include "partial.html" with foo="bar" baz="qux" %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_include_tag
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (assignment
        (variable_name)
        (filter_expression
          (primary_expression
            (literal
              (string)))))
      (assignment
        (variable_name)
        (filter_expression
          (primary_expression
            (literal
              (string))))))))

================================================================================
Django if with comparison operators
================================================================================

{% if a == b and c != d %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))
              (and_keyword)
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django if with is not comparison
================================================================================

{% if value is not None %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django if with not in comparison
================================================================================

{% if item not in items %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django plain lookup
================================================================================

{{ user.profile.name }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)
          (identifier)
          (identifier))))))

================================================================================
Django string literal
================================================================================

{{ "hi" }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (string))))))

================================================================================
Django filter arg lookup
================================================================================

{{ var|default_if_none:var2 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)))
      (filter_call
        (filter_name)
        (filter_argument
          (lookup
            (identifier)))))))

================================================================================
Django literal with punctuation arg
================================================================================

{{ "string"|filter:"quoted argument, with non-word characters!" }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (string)))
      (filter_call
        (filter_name)
        (filter_argument
          (literal
            (string)))))))

================================================================================
Django line comment with braces
================================================================================

{# {% #}

--------------------------------------------------------------------------------

(document
  (django_line_comment))

================================================================================
Django line comment with percent then text
================================================================================

foo{# %} #}bar

--------------------------------------------------------------------------------

(document
  (text)
  (django_line_comment)
  (text))

================================================================================
Django block comment hides tags
================================================================================

{% comment %} {% if %} {% endcomment %}

--------------------------------------------------------------------------------

(document
  (django_block_comment
    (comment_content)))

================================================================================
Django block comment hides variables
================================================================================

foo{% comment %}{{ x }}{% endcomment %}bar

--------------------------------------------------------------------------------

(document
  (text)
  (django_block_comment
    (comment_content))
  (text))

================================================================================
Django if unary not
================================================================================

{% if not user.is_active %}inactive{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (not_expression
                  (comparison_expression
                    (filter_expression
                      (primary_expression
                        (lookup
                          (identifier)
                          (identifier)))))))))))
      (text)
      (django_endif))))

================================================================================
Django firstof with as
================================================================================

{% firstof a b "fallback" as chosen %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_firstof_tag
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (variable_name))))

================================================================================
Django ifchanged with else
================================================================================

{% ifchanged total %}A{% else %}B{% endifchanged %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_ifchanged_block
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (text)
      (text))))

================================================================================
Django regroup tag
================================================================================

{% regroup items by category as grouped %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_regroup_tag
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (lookup
        (identifier))
      (variable_name))))

================================================================================
Django widthratio with as
================================================================================

{% widthratio a b 100 as pct %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_widthratio_tag
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (filter_expression
        (primary_expression
          (literal
            (number))))
      (variable_name))))

================================================================================
Django now tag with as
================================================================================

{% now "jS F" as formatted %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_now_tag
      (string)
      (variable_name))))

================================================================================
Django templatetag braces
================================================================================

{% templatetag openbrace %}{% templatetag closebrace %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_templatetag_tag))
  (django_statement
    (django_templatetag_tag)))

================================================================================
Django generic tag with as
================================================================================

{% static "admin/app.js" as asset_url %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_generic_tag
      (generic_tag_name)
      (tag_argument
        (as_alias
          (filter_expression
            (primary_expression
              (literal
                (string))))
          (variable_name))))))

================================================================================
Django debug tag
================================================================================

{% debug %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_debug_tag)))

================================================================================
Django with underscore alias
================================================================================

{% with foo as _bar %}X{% endwith %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_with_block
      (django_with_open
        (with_legacy
          (filter_expression
            (primary_expression
              (lookup
                (identifier))))
          (variable_name)))
      (text)
      (django_endwith))))

================================================================================
Django with assignment spaces invalid (ERROR)
================================================================================

{% with foo =1 %}{% endwith %}

--------------------------------------------------------------------------------

(document
  (ERROR
    (filter_expression
      (primary_expression
        (lookup
          (identifier))))
    (numeric_index)
    (end_tag_name)
    (UNEXPECTED '\0')))

================================================================================
Django url named args spacing invalid (ERROR)
================================================================================

{% url "view-name" id = foo.slug %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_url_tag
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (ERROR)
      (filter_expression
        (primary_expression
          (lookup
            (identifier)
            (identifier)))))))

================================================================================
Django filter colon space after invalid (ERROR)
================================================================================

{{ x|default: "y" }}

--------------------------------------------------------------------------------

; Django does not allow whitespace after the colon in filter arguments
(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)))
      (filter_call
        (filter_name)))
    (ERROR
      (UNEXPECTED ':')
      (identifier))))

================================================================================
Django filter colon space before invalid (ERROR)
================================================================================

{{ x|default :"y" }}

--------------------------------------------------------------------------------

; Django does not allow whitespace before the colon in filter arguments
(document
  (django_interpolation
    (ERROR
      (filter_expression
        (primary_expression
          (lookup
            (identifier)))
        (filter_call
          (filter_name)))
      (UNEXPECTED ':'))
    (filter_expression
      (primary_expression
        (literal
          (string))))))

================================================================================
Django block comment with note
================================================================================

{% comment "note" %}hidden{% endcomment %}

--------------------------------------------------------------------------------

(document
  (django_block_comment
    (comment_text)
    (comment_content)))

================================================================================
Django generic block with as_alias
================================================================================

{% cache 60 sidebar request.user as cached %}content{% endcache %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_generic_block
      (generic_tag_name)
      (tag_argument
        (filter_expression
          (primary_expression
            (literal
              (number)))))
      (tag_argument
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (tag_argument
        (as_alias
          (filter_expression
            (primary_expression
              (lookup
                (identifier)
                (identifier))))
          (variable_name)))
      (text)
      (end_tag_name))))

================================================================================
Django url with named args and as
================================================================================

{% url "view-name" id=foo.slug page=2 as the_url %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_url_tag
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (named_argument
        (argument_name)
        (filter_expression
          (primary_expression
            (lookup
              (identifier)
              (identifier)))))
      (named_argument
        (argument_name)
        (filter_expression
          (primary_expression
            (literal
              (number)))))
      (variable_name))))

================================================================================
Django for reversed tuple unpack with empty
================================================================================

{% for x, y in items reversed %}{{ x }}{{ y }}{% empty %}none{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name)
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_empty_branch
        (django_empty)
        (text))
      (django_endfor))))

================================================================================
Django include only with order
================================================================================

{% include "tmpl.html" only with foo="bar" %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_include_tag
      (filter_expression
        (primary_expression
          (literal
            (string))))
      (assignment
        (variable_name)
        (filter_expression
          (primary_expression
            (literal
              (string))))))))

================================================================================
Django ifchanged with multiple args
================================================================================

{% ifchanged a b %}changed{% else %}same{% endifchanged %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_ifchanged_block
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (text)
      (text))))

================================================================================
Django cycle with i18n values
================================================================================

{% cycle _("one") _("two") as choice %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_cycle_tag
      (cycle_value
        (filter_expression
          (primary_expression
            (literal
              (i18n_string)))))
      (cycle_value
        (filter_expression
          (primary_expression
            (literal
              (i18n_string)))))
      (variable_name))))

================================================================================
Django generic tag with as_alias (trans)
================================================================================

{% trans "Hello" as greeting %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_generic_tag
      (generic_tag_name)
      (tag_argument
        (as_alias
          (filter_expression
            (primary_expression
              (literal
                (string))))
          (variable_name))))))

================================================================================
Django verbatim mismatched suffix (suffix enforced)
================================================================================

{% verbatim foo %}content{% endverbatim bar %}

--------------------------------------------------------------------------------

; The endverbatim with wrong suffix doesn't close the block, so verbatim
; consumes until EOF (empty content), then remaining is parsed separately

(document
  (django_statement
    (django_verbatim_block))
  (text)
  (ERROR
    (identifier)
    (identifier)
    (UNEXPECTED '\0')))

================================================================================
Django if comparison after and
================================================================================

{% if a == b and c != d %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))
              (and_keyword)
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django if comparison after or
================================================================================

{% if a == b or c != d %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier)))))))
            (or_keyword)
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django if mixed comparisons with and or
================================================================================

{% if a == b and c != d or e >= f %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))
              (and_keyword)
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier)))))))
            (or_keyword)
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Django regroup then unpack
================================================================================

{% regroup data by bar as grouped %}{% for grouper, group in grouped %}{{ grouper }}{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_regroup_tag
      (filter_expression
        (primary_expression
          (lookup
            (identifier))))
      (lookup
        (identifier))
      (variable_name)))
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name)
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_interpolation
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_endfor))))

================================================================================
Django cycle with reset
================================================================================

{% for item in items %}{% cycle 'a' 'b' as row %}{% resetcycle row %}{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_statement
        (django_cycle_tag
          (cycle_value
            (string))
          (cycle_value
            (string))
          (variable_name)))
      (django_statement
        (django_resetcycle_tag
          (cycle_name)))
      (django_endfor))))

================================================================================
Django filter arg dotted lookup
================================================================================

{{ value|default:settings.DEFAULT_VALUE }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (lookup
          (identifier)))
      (filter_call
        (filter_name)
        (filter_argument
          (lookup
            (identifier)
            (identifier)))))))

================================================================================
Django cycle nested ifchanged
================================================================================

{% for item in items %}{% ifchanged item.category %}{% cycle 'odd' 'even' %}{% endifchanged %}{% endfor %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_for_block
      (django_for_open
        (loop_variables
          (variable_name))
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))
      (django_statement
        (django_ifchanged_block
          (filter_expression
            (primary_expression
              (lookup
                (identifier)
                (identifier))))
          (django_statement
            (django_cycle_tag
              (cycle_value
                (string))
              (cycle_value
                (string))))))
      (django_endfor))))

================================================================================
Django nested block comments (unsupported)
================================================================================

{% comment %}
{% comment %}
inner
{% endcomment %}
{% endcomment %}

--------------------------------------------------------------------------------

; Django does not support nested block comments. The first {% endcomment %}
; closes the outer comment block, and the second {% endcomment %} is parsed
; as a generic tag (unknown tag name).

(document
  (django_block_comment
    (comment_content))
  (ERROR
    (identifier)
    (UNEXPECTED '\0')))

================================================================================
Django number with leading decimal
================================================================================

{{ .5 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (number))))))

================================================================================
Django number scientific notation
================================================================================

{{ 1e10 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (number))))))

================================================================================
Django number scientific with decimal
================================================================================

{{ 1.5e-3 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (number))))))

================================================================================
Django negative number
================================================================================

{{ -123 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (number))))))

================================================================================
Django positive number with sign
================================================================================

{{ +456 }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (number))))))

================================================================================
Django string escaped quote
================================================================================

{{ 'it\'s' }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (string))))))

================================================================================
Django string escape sequence
================================================================================

{{ "line\nbreak" }}

--------------------------------------------------------------------------------

(document
  (django_interpolation
    (filter_expression
      (primary_expression
        (literal
          (string))))))

================================================================================
Django chained comparison operators
================================================================================

{% if a == b != c < d <= e > f >= g %}yes{% endif %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_if_block
      (django_if_open
        (test_expression
          (or_expression
            (and_expression
              (not_expression
                (comparison_expression
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))
                  (comparison_operator)
                  (filter_expression
                    (primary_expression
                      (lookup
                        (identifier))))))))))
      (text)
      (django_endif))))

================================================================================
Sequential built-in simple tags
================================================================================

{% csrf_token %}
{% debug %}
{% csrf_token %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_csrf_token_tag))
  (django_statement
    (django_debug_tag))
  (django_statement
    (django_csrf_token_tag)))

================================================================================
Sequential generic tags
================================================================================

{% custom_tag arg %}
{% another_tag %}

--------------------------------------------------------------------------------

(document
  (django_statement
    (django_generic_tag
      (generic_tag_name)
      (tag_argument
        (filter_expression
          (primary_expression
            (lookup
              (identifier)))))))
  (django_statement
    (django_generic_tag
      (generic_tag_name))))
